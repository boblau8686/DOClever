{"version":3,"sources":["webpack:///./web/projectinfo/projectinfo.js"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,CAAC,C","file":"projectinfo.js","sourcesContent":["/**\n * Created by sunxin on 2016/12/22.\n */\nvar mainNav=require(\"../component/mainNav.vue\")\nvar interface=require(\"./interface/interface.vue\")\nvar setting=require(\"./setting/setting.vue\")\nvar global=require(\"./global/global.vue\")\nvar test=require(\"./test/test.vue\")\nvar version=require(\"./version/version.vue\")\nvar config=require(\"../util/config\");\nvar itemAuto=require(\"../component/autocompleteItem.vue\");\nvar store=require(\"./store\");\nvar sessionChange=require(\"../mixins/session\");\nif(!session.get(\"projectId\"))\n{\n    location.href=\"../project/project.html\"\n}\nsession.remove(\"snapshotId\");\nsession.remove(\"snapshotDis\");\nsession.remove(\"snapshotCreator\");\nsession.remove(\"snapshotDate\");\nVue.component(\"itemauto\",itemAuto);\nvar vue=new Vue({\n    el: \"#app\",\n    data: {\n        type:0,\n        arrApply:[],\n        showApply:false,\n        selProject:session.get(\"projectName\")\n    },\n    store:store,\n    mixins:[sessionChange],\n    components:{\n        \"mainnav\":mainNav,\n        \"interface\":interface,\n        \"setting\":setting,\n        \"global\":global,\n        \"test\":test,\n        \"version\":version\n    },\n    methods:{\n        handleApply:function (item,state) {\n            var _this=this;\n            $.startHud();\n            net.put(\"/project/handleapply\",{\n                id:session.get(\"projectId\"),\n                apply:item._id,\n                state:state\n            }).then(function (data) {\n                $.stopHud();\n                if(data.code==200)\n                {\n                    if(state==1)\n                    {\n                        item.handle=1;\n                        setTimeout(function () {\n                            location.href=\"../project/project.html\"\n                        },1000);\n                    }\n                    else\n                    {\n                        item.handle=2;\n                    }\n                }\n                else\n                {\n                    item.handle=3;\n                    $.notify(data.msg,0);\n                }\n            })\n        },\n        querySearch:function (queryString,cb) {\n            var _this=this;\n            var query={\n                name:\"\"\n            }\n            if(_this.session.teamId)\n            {\n                query.team=_this.session.teamId\n            }\n            net.get(\"/project/filterlist\",query).then(function (data) {\n                if(data.code==200)\n                {\n                    var results=data.data.map(function (obj) {\n                        return {\n                            value:obj.name,\n                            remark:obj.dis!=\"undefined\"?obj.dis:\"\",\n                            id:obj._id,\n                            own:obj.own,\n                            role:obj.role\n                        }\n                    })\n                    cb(results);\n                }\n                else\n                {\n                    $.notify(data.msg,0);\n                    cb([]);\n                }\n            })\n        },\n        showAutoComplete:function (event) {\n            setTimeout(function(){\n                event.target.nextSibling.focus();\n            },100)\n        },\n        changeProject:function (obj) {\n            session.set(\"projectId\",obj.id);\n            session.set(\"projectName\",obj.value);\n            store.state.lastBaseUrl=\"\"\n            location.reload();\n        },\n    },\n    created:function () {\n        var _this=this;\n        Promise.all([\n            net.get(\"/project/interface\",{\n                id:session.get(\"projectId\")\n            }),\n            net.get(\"/project/info\",{\n                id:session.get(\"projectId\")\n            }),\n            net.get(\"/status/list\",{\n                id:session.get(\"projectId\")\n            }),\n            net.get(\"/test/list\",{\n                project:session.get(\"projectId\")\n            }),\n            net.get(\"/project/applylist\",{\n                id:session.get(\"projectId\")\n            }),\n            net.get(\"/version/list\",{\n                project:session.get(\"projectId\"),\n                page:0\n            })\n        ]).then(function (values) {\n            $.stopLoading();\n            var obj1=values[0];\n            var obj2=values[1];\n            var obj3=values[2];\n            var obj4=values[3];\n            var obj5=values[4];\n            var obj6=values[5];\n            if(obj1.code==200)\n            {\n                store.dispatch(\"interface/getAllInterface\",obj1.data)\n            }\n            else\n            {\n                throw obj1.msg;\n            }\n            if(obj2.code==200)\n            {\n                store.commit(\"setProject\",obj2.data);\n            }\n            else\n            {\n                throw obj2.msg;\n            }\n            if(obj3.code==200)\n            {\n                store.commit(\"setStatus\",obj3.data);\n            }\n            else\n            {\n                throw obj3.msg;\n            }\n            if(obj4.code==200)\n            {\n                store.state.event.$emit(\"initTest\",obj4.data);\n            }\n            else\n            {\n                throw obj4.msg;\n            }\n            if(store.state.role==0)\n            {\n                if(obj5.code==200)\n                {\n                    obj5.data.forEach(function (obj) {\n                        obj.handle=0;\n                    })\n                    _this.arrApply=obj5.data;\n                    if(_this.arrApply.length>0)\n                    {\n                        _this.showApply=true;\n                    }\n                }\n                else\n                {\n                    throw obj5.msg;\n                }\n            }\n            if(obj6.code==200)\n            {\n                store.state.event.$emit(\"initVersion\",obj6.data);\n            }\n            else\n            {\n                throw obj6.msg;\n            }\n            store.state.event.$emit(\"init\");\n        }).catch(function (err) {\n            $.stopLoading();\n            if(typeof(err)==\"string\")\n            {\n                $.notify(err,0);\n            }\n            else\n            {\n                $.notify(\"获取失败\",0);\n            }\n        })\n    },\n    mounted:function () {\n        document.getElementById(\"projectChange\").getElementsByTagName(\"input\")[0].readOnly=true;\n    }\n})\nwindow.vueObj=vue;\n$.ready(function () {\n    $.startLoading();\n})\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./web/projectinfo/projectinfo.js\n// module id = 296\n// module chunks = 8"],"sourceRoot":""}